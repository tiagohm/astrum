package br.tiagohm.astrum.sky.core.ephemeris

import br.tiagohm.astrum.sky.M_PI_180
import br.tiagohm.astrum.sky.core.Algorithms
import kotlin.math.cos
import kotlin.math.sin

/**
 * The Ephemerides of the Martian satellites (adjustement from 1877 to 2005, Version 1.0)
 * by Valery Lainey can be obtained from Valery Lainey.
 */
object MarsSat {

    fun computeCoordinates(jd: Double, body: Int): DoubleArray {
        return computeOsculatingCoordinates(jd, jd, body)
    }

    fun computeOsculatingCoordinates(jd0: Double, jd: Double, body: Int): DoubleArray {
        val t = jd0 - 2451545.0 + 6491.5

        val ts = doubleArrayOf(t0, t1, t2)
        val es = arrayOf(elem0, elem1, elem2)

        Algorithms.computeInterpolatedElements(t, elem, DIM, ::computeMarsSatElem, DELTA_T, ts, es)

        t0 = ts[0]
        t1 = ts[1]
        t2 = ts[2]

        val vsop87 = DoubleArray(9)

        generateMarsSatToVSOP87(t, vsop87)

        val be = elem.sliceArray(body * 6 until body * 6 + 6)
        val x = Algorithms.ellipticToRectangularA(SATS[body].mu, be, jd - jd0)

        return doubleArrayOf(
            vsop87[0] * x[0] + vsop87[1] * x[1] + vsop87[2] * x[2],
            vsop87[3] * x[0] + vsop87[4] * x[1] + vsop87[5] * x[2],
            vsop87[6] * x[0] + vsop87[7] * x[1] + vsop87[8] * x[2],
            vsop87[0] * x[3] + vsop87[1] * x[4] + vsop87[2] * x[5],
            vsop87[3] * x[3] + vsop87[4] * x[4] + vsop87[5] * x[5],
            vsop87[6] * x[3] + vsop87[7] * x[4] + vsop87[8] * x[5],
        )
    }

    private fun computeMarsSatElem(t: Double, elem: DoubleArray) {
        val a = DoubleArray(6)

        elem.copyInto(a, 0, 0, 6)
        computeElements(t, 0, a)
        a.copyInto(elem, 0)

        elem.copyInto(a, 0, 6, 12)
        computeElements(t, 1, a)
        a.copyInto(elem, 6)
    }

    private fun computeElements(t: Double, body: Int, elem: DoubleArray) {
        val bp = SATS[body]

        bp.constants.copyInto(elem)

        for (j in 0..1) {
            for (p in bp.terms[j]) {
                val d = p.phase * t * p.frequency
                elem[j] += p.amplitude * cos(d)
            }
        }

        for (j in 2..3) {
            for (p in bp.terms[j]) {
                val d = p.phase * t * p.frequency
                elem[2 * j - 2] += p.amplitude * cos(d)
                elem[2 * j - 1] += p.amplitude * sin(d)
            }
        }

        elem[1] += (bp.l + bp.acc * t) * t
    }

    private fun generateMarsSatToVSOP87(t: Double, vsop87: DoubleArray) {
        val t0 = t - 6491.5

        val ome = (OME0 + DOME * t0 / 36525.0) * M_PI_180
        val inc = (INC0 + DINC * t0 / 36525.0) * M_PI_180

        val co = cos(ome)
        val so = sin(ome)
        val ci = cos(inc)
        val si = sin(inc)

        val m = DoubleArray(9)

        m[0] = co
        m[1] = -ci * so
        m[2] = si * so
        m[3] = so
        m[4] = ci * co
        m[5] = -si * co
        m[6] = 0.0
        m[7] = si
        m[8] = ci

        val a = J2000_TO_VSOP87

        for (i in 0..2) {
            for (j in 0..2) {
                vsop87[i * 3 + j] = a[i * 3] * m[j] + a[i * 3 + 1] * m[3 + j] + a[i * 3 + 2] * m[6 + j]
            }
        }
    }

    private class Term(
        val phase: Double,
        val frequency: Double,
        val amplitude: Double,
    )

    private class Sat(
        val mu: Double,
        val l: Double,
        val acc: Double,
        val constants: DoubleArray,
        val terms: Array<Array<Term>>,
    )

    private const val DIM = 2 * 6
    private const val DELTA_T = 1.0 // 1 day

    private var t0 = -1E100
    private var t1 = -1E100
    private var t2 = -1E100

    private val elem = DoubleArray(DIM)
    private val elem0 = DoubleArray(DIM)
    private val elem1 = DoubleArray(DIM)
    private val elem2 = DoubleArray(DIM)

    private const val OME0 = 47.68143
    private const val INC0 = 37.1135
    private const val DOME = -0.1061
    private const val DINC = 0.0609

    private val J2000_TO_VSOP87 = doubleArrayOf(
        9.999999999998848E-01, -4.799655442984222E-07, 0.000000000000000E+00,
        4.403598133110236E-07, 9.174821370868568E-01, 3.977769829016507E-01,
        -1.909192461077750E-07, -3.977769829016049E-01, 9.174821370869625E-01,
    )

    private val PHOBOS_0 = arrayOf(
        Term(5.013490350126586E+00, 2.715567382195733E+01, 4.537539999999999E-09),
        Term(6.839910590780000E-01, 1.969446151585829E+01, 7.312000000000000E-10),
        Term(4.514031245592586E+00, 4.073350897245015E+01, 7.785599999999993E-10),
        Term(5.531351678889586E+00, 1.357783661756435E+01, 3.529399999999985E-10),
        Term(5.700307292822586E+00, 4.685013393001369E+01, 2.094599999999994E-10),
        Term(4.228062220664587E+00, 5.431134764391466E+01, 9.139999999999999E-11),
        Term(1.167907583017500E+00, 7.461211875946264E+00, 6.204000000000000E-11),
        Term(5.197274703601086E+00, 6.042797388545593E+01, 5.295999999999951E-11),
        Term(5.160045430868086E+00, 3.938582310889583E+01, 1.811999999999999E-11),
        Term(2.223277229900500E+00, 5.777452001970681E+01, 1.563999999999897E-11),
        Term(6.921616240614999E-01, 2.103904892768837E+01, 1.535999999999999E-11),
        Term(6.215802752555586E+00, 3.327229783044108E+01, 1.304000000000000E-11),
        Term(1.368231494011000E+00, 3.938892179708230E+01, 1.661999999999999E-11),
        Term(2.601539199675000E-01, 7.446011234647927E+00, 1.328000000000000E-11),
        Term(5.903845687100000E-02, 3.941932465627423E+01, 8.559999999999978E-12),
        Term(6.179310844209586E+00, 5.911910805492755E+01, 7.240000000000000E-12),
    )

    private val PHOBOS_1 = arrayOf(
        Term(5.334169568271586E+00, 9.145914066599032E-03, 5.016848130000000E-05),
        Term(5.334169148295587E+00, 9.145914113327495E-03, 5.016848130000000E-05),
        Term(3.805345265960000E-01, 1.540952541904328E-03, 3.350264970000000E-05),
        Term(3.805339484960000E-01, 1.540952613104260E-03, 3.350264903000000E-05),
        Term(5.288363718535586E+00, 1.829243888046791E-02, 2.827839093000000E-05),
        Term(5.288363809359586E+00, 1.829243887034939E-02, 2.827839093000000E-05),
        Term(3.412685718051586E+00, 7.604696023359408E-03, 1.578862428000000E-05),
        Term(3.412685998796586E+00, 7.604695992157328E-03, 1.578862427000000E-05),
        Term(3.448999855869586E+00, 2.715567616927210E+01, 3.008844320000000E-05),
        Term(9.194445444030001E-01, 3.101144183892481E-03, 8.178563170000001E-06),
        Term(9.194443192780000E-01, 3.101144208596499E-03, 8.178563340000000E-06),
        Term(5.387625479307586E+00, 1.969446275049270E+01, 2.044327843999999E-05),
        Term(2.848996739890000E+00, 2.743829098982358E-02, 6.516951720000000E-06),
        Term(2.848996748767000E+00, 2.743829098862537E-02, 6.516951720000000E-06),
        Term(3.954411167839586E+00, 1.357783808463605E+01, 1.013316988000000E-05),
        Term(2.912659283736000E+00, 4.073351425390815E+01, 7.483468759999740E-06),
        Term(4.067858164824586E+00, 2.589727369338346E-02, 2.589359390000000E-06),
        Term(4.067857973471586E+00, 2.589727371473152E-02, 2.589359390000000E-06),
        Term(3.776271613850000E-01, 3.658417828853650E-02, 1.125147420000000E-06),
        Term(3.776267985560000E-01, 3.658417832900902E-02, 1.125147420000000E-06),
        Term(4.121936540919586E+00, 4.685014091671000E+01, 1.523532599999976E-06),
        Term(1.231836210236000E+00, 1.674957754399965E-02, 4.976512300000000E-07),
        Term(1.231836585135000E+00, 1.674957750247454E-02, 4.976512300000000E-07),
        Term(2.488083095032000E+00, 1.520386207875350E-02, 6.841966800000000E-07),
        Term(2.488083105051000E+00, 1.520386207728190E-02, 6.841966800000000E-07),
        Term(1.576141880659500E+00, 3.504321962396548E-02, 1.124868580000000E-06),
        Term(6.145328698142587E+00, 6.116624841770791E+00, 7.873411399999999E-07),
        Term(2.626756105114500E+00, 5.431135233854420E+01, 1.040645720000000E-06),
        Term(2.759579551372000E+00, 7.461213382164448E+00, 7.166789399999994E-07),
        Term(6.005673273380586E+00, 1.314187651672942E+00, 6.022022799999936E-07),
        Term(9.353090056600000E-02, 7.532115638546220E-04, 1.964976900000000E-07),
        Term(9.343265452500001E-02, 7.532237916966188E-04, 1.964964500000000E-07),
        Term(4.302928383505000E-01, 3.938582557777600E+01, 4.987307800000000E-07),
        Term(3.587439959397586E+00, 6.042797969706294E+01, 4.804827999999994E-07),
        Term(4.183547650369587E+00, 4.572998195120822E-02, 1.747133100000000E-07),
        Term(4.183547815926586E+00, 4.572998193123842E-02, 1.747133100000000E-07),
        Term(5.589444380180586E+00, 6.068411018120026E-03, 1.793076700000000E-07),
        Term(5.589445119118587E+00, 6.068410936124942E-03, 1.793076800000000E-07),
        Term(6.062696336024086E+00, 3.938892673561993E+01, 2.653755199999908E-07),
        Term(4.628882088425586E+00, 3.327230135427769E+01, 2.539272800000000E-07),
        Term(4.736462571780586E+00, 1.224558395734566E-02, 1.254715400000000E-07),
        Term(4.736462588777586E+00, 1.224558396211886E-02, 1.254715500000000E-07),
    )

    private val PHOBOS_2 = arrayOf(
        Term(1.404382124885000E+00, 7.595588511174286E-03, 1.514110912521000E-02),
        Term(2.088385523034000E+00, 1.970205682773437E+01, 3.849620867400000E-04),
        Term(3.895377361148586E+00, 1.069670280268190E-02, 6.903413242000000E-05),
        Term(4.989572094750000E-01, -7.605272825959576E-03, 4.946101994000000E-05),
        Term(8.215210221720000E-01, 4.685772969905357E+01, 3.671320788000000E-05),
        Term(3.378076387479586E+00, -7.453616316894914E+00, 3.267983782000000E-05),
        Term(2.772375719698000E+00, 3.939651873194720E+01, 8.750483050000000E-06),
        Term(2.839303414769000E+00, 6.124220388371520E+00, 6.170938810000000E-06),
        Term(3.184503170430000E-01, 6.043556479692822E+01, 6.957005940000000E-06),
        Term(1.410329121503000E+00, 1.984322681200531E-02, 5.734088960000000E-06),
        Term(1.336796551701000E+00, 3.327989343110183E+01, 3.431577860000000E-06),
        Term(3.853646745987586E+00, -2.103145308554279E+01, 4.037409510000000E-06),
        Term(2.547067366210000E-01, 1.549665594221090E-03, 2.115296220000000E-06),
        Term(1.508224230072000E+00, -5.911151611514718E+01, 1.904827620000000E-06),
        Term(3.462607551400000E-02, -5.165030141480156E+01, 8.696094700000001E-07),
        Term(3.198655314207586E+00, 9.152774292423818E-03, 6.329868200000000E-07),
        Term(5.163954670916587E+00, 1.674080796065678E-02, 6.130317800000000E-07),
        Term(7.803937436990001E-01, -1.550610622055567E-03, 5.737217100000000E-07),
        Term(3.264588234538586E+00, 2.716326950857758E+01, 8.181088300000000E-07),
        Term(5.211329429707586E+00, 2.898903518276566E-02, 7.434145300000000E-07),
        Term(2.691716763490000E+00, -2.714807769012140E+01, 5.441647800000001E-07),
        Term(1.001733960626000E+00, -4.553367734785991E+01, 5.044515000000000E-07),
        Term(3.212149602842586E+00, -1.968376490094933E+01, 4.284599100000000E-07),
        Term(4.145658249560586E+00, -3.460928932187340E+01, 4.224937300000000E-07),
        Term(5.063879137454586E+00, 2.589097180762378E-02, 3.581949800000000E-07),
        Term(2.558639707373000E+00, 6.064928432880783E-03, 3.808881200000000E-07),
        Term(5.292499025555586E+00, 3.075065445597794E-03, 4.055739200000000E-07),
    )

    private val PHOBOS_3 = arrayOf(
        Term(2.058107128488000E+00, -7.604861328578004E-03, 9.408605183120001E-03),
        Term(3.248856489376586E+00, -9.145863467943084E-03, 5.699538102000000E-05),
        Term(4.557280987272586E+00, 1.829238959116374E-02, 2.474369483000000E-05),
        Term(6.113423353213586E+00, 7.595702278066188E-03, 2.062715397000000E-05),
        Term(2.067112903892000E+00, 2.743825478464904E-02, 5.945574160000000E-06),
        Term(1.700689207004000E+00, 9.145729527513899E-03, 3.920190200000000E-06),
        Term(3.577059353926586E+00, -1.829259493439447E-02, 2.167791970000000E-06),
        Term(4.940284891770586E+00, -7.453616316894914E+00, 2.769763750000000E-06),
        Term(2.117885747855000E+00, 3.941171892425920E+01, 1.813539170000000E-06),
        Term(5.176055365230000E-01, 1.970205682773437E+01, 1.083429180000000E-06),
        Term(5.864248782211586E+00, 3.658425999636452E-02, 1.066657010000000E-06),
        Term(3.240692168340586E+00, 2.589639535977297E-02, 7.909853300000000E-07),
        Term(7.570751994340000E-01, -1.321790869500707E+00, 8.880885099999999E-07),
        Term(6.608910796060000E-01, 6.124220388371520E+00, 5.520758900000000E-07),
        Term(5.519669134088586E+00, 4.685772969905357E+01, 4.397886000000000E-07),
        Term(5.844000094873587E+00, -2.743825733444110E-02, 4.583609100000000E-07),
        Term(4.602755395228586E+00, -1.675516082048598E-02, 3.533131100000000E-07),
        Term(2.685649467156000E+00, 1.542518910643103E-03, 3.502988500000000E-07),
        Term(3.353176877809586E+00, 1.225604581839110E+01, 3.828851700000000E-07),
        Term(2.556761413073000E+00, 1.068971473943851E-02, 2.711247300000000E-07),
        Term(4.622369718415587E+00, -2.589682634097252E-02, 1.991745400000000E-07),
        Term(7.497690894330000E-01, 3.504362063026418E-02, 2.036897700000000E-07),
        Term(3.965205602751586E+00, 2.714806830611846E+01, 1.726779600000000E-07),
        Term(4.743858488241586E+00, -2.103145308554279E+01, 1.574472800000000E-07),
        Term(3.405870070134586E+00, 4.572380100924578E-02, 1.698567700000000E-07),
        Term(3.742380849210000E-01, 3.327989343110183E+01, 1.015004500000000E-07),
        Term(1.374678754422000E+00, -1.970206671243377E+01, 8.259149000000001E-08),
        Term(1.140160118874000E+00, -6.108652383295211E-03, 8.504923000000000E-08),
    )

    private val DEIMOS_0 = arrayOf(
        Term(6.146803530569087E+00, 2.294413036846356E+00, 5.398360000000000E-09),
        Term(3.432805186019586E+00, 9.935735425667586E+00, 7.095199999999997E-10),
        Term(4.356581106602587E+00, 3.441619555269535E+00, 3.737800000000000E-10),
        Term(5.915601483397086E+00, 9.926589650598594E+00, 2.337400000000000E-10),
        Term(1.615243161446500E+00, 1.147206518423178E+00, 1.697000000000000E-10),
        Term(2.114704906116000E+00, 9.917443791162608E+00, 5.314000000000000E-11),
        Term(9.393388277920001E-01, 9.954027953247621E+00, 7.046000000000000E-11),
        Term(3.949494792732586E+00, 9.944881541450725E+00, 4.233999999999998E-11),
        Term(2.089322391969500E+00, 2.294097606691310E+00, 2.813999999999983E-11),
        Term(7.795571756865000E-01, 2.294728469946876E+00, 2.549999999999971E-11),
        Term(2.361851669664500E+00, 4.588826073692712E+00, 1.676000000000000E-11),
        Term(2.770026883578500E+00, 9.954658773106329E+00, 9.719999999999976E-12),
        Term(4.733522308629587E+00, 9.963173826265681E+00, 9.519999999999998E-12),
        Term(3.258781379519086E+00, 1.472506551307767E+01, 9.739999999999990E-12),
        Term(4.596299836113586E+00, 9.908297894321850E+00, 1.027999999999982E-11),
        Term(3.057688443346500E+00, 2.682916339604879E+00, 6.679999999999999E-12),
        Term(5.453932177963086E+00, 2.682285947505377E+00, 6.879999999999995E-12),
        Term(4.328499239462586E+00, 9.936050924435195E+00, 6.199999999999996E-12),
        Term(2.168321380562000E+00, 4.976699000854042E+00, 5.359999999999916E-12),
        Term(2.516818588675000E+00, 9.935420104041299E+00, 3.359999999999995E-12),
        Term(2.997827070725000E-01, 3.441304123224338E+00, 2.919999999999998E-12),
        Term(2.143143420462500E+00, 2.682600911813873E+00, 2.979999999999999E-12),
        Term(5.271781540988586E+00, 3.441934988580561E+00, 2.640000000000000E-12),
        Term(5.382287205930000E-01, 9.926905039305762E+00, 2.039999999999966E-12),
        Term(3.629187963751586E+00, 2.303558945733479E+00, 1.090000000000000E-12),
    )

    private val DEIMOS_1 = arrayOf(
        Term(2.488175621789000E+00, 3.153377646687549E-04, 2.483031660190000E-03),
        Term(2.488175634463000E+00, 3.153377641537758E-04, 2.483031659490000E-03),
        Term(5.336889264964586E+00, 9.145915158660612E-03, 2.023426978200000E-04),
        Term(5.336889346905586E+00, 9.145915155199243E-03, 2.023426978200000E-04),
        Term(5.281538321363586E+00, 1.829244561727392E-02, 1.043167564200000E-04),
        Term(5.281537958522586E+00, 1.829244563271799E-02, 1.043167564300000E-04),
        Term(1.433490018835500E+00, 2.294413045224799E+00, 1.637133774599998E-04),
        Term(2.852007788337500E+00, 2.743818628432718E-02, 4.820671420000000E-05),
        Term(3.147176604035586E+00, 1.860783561096842E-02, 1.497066023000000E-05),
        Term(3.147176307034586E+00, 1.860783562364318E-02, 1.497066034000000E-05),
        Term(3.182516662993086E+00, 1.147206709032795E+00, 1.137028858000000E-05),
        Term(5.917181875408586E+00, 3.441620120814550E+00, 8.350609860000001E-06),
        Term(3.544871659744586E+00, 6.190897763118658E-04, 4.383254500000000E-06),
        Term(3.544871649035586E+00, 6.190897769462623E-04, 4.383254500000000E-06),
        Term(4.614193383590000E-01, 3.657933964533806E-02, 8.316176420000001E-06),
        Term(6.754222685930000E-01, 2.775277029221846E-02, 6.447587580000001E-06),
        Term(5.001640850015586E+00, 9.935735582783501E+00, 7.926687400000001E-06),
        Term(4.485218623803586E+00, 8.828439970895009E-03, 3.905064210000000E-06),
        Term(2.221013917980000E-01, 9.464721723028089E-03, 3.117801830000000E-06),
        Term(4.485218622895586E+00, 8.828439971019056E-03, 3.905064210000000E-06),
        Term(2.221013944660000E-01, 9.464721722885516E-03, 3.117801830000000E-06),
    )

    private val DEIMOS_2 = arrayOf(
        Term(2.198649419514000E+00, 3.148401892560942E-04, 2.744131534600000E-04),
        Term(4.366636518977586E+00, 4.977013897776327E+00, 6.015912711000000E-05),
        Term(1.463816210370000E+00, -3.153164045300449E-04, 3.614585349000000E-05),
        Term(1.362467588064000E+00, 2.682600831640474E+00, 2.577157903000000E-05),
        Term(9.336792893320000E-01, -4.958721582505435E+00, 6.801997830000000E-06),
        Term(3.152432010349586E+00, 1.535394310272536E+00, 4.452979140000000E-06),
        Term(4.734051493918586E+00, -4.949575691510945E+00, 2.238482920000000E-06),
        Term(5.736642853342587E+00, 2.327524649334390E-04, 1.478747570000000E-06),
        Term(5.084945958505586E+00, 3.912335403634271E-04, 1.457720040000000E-06),
        Term(4.232770650771586E+00, 7.271426904652134E+00, 1.347030310000000E-06),
        Term(1.516439412109000E+00, 1.491274947692300E+01, 7.538179100000001E-07),
        Term(3.100618466711000E+00, 1.797748798526167E-02, 8.716229700000000E-07),
        Term(5.155432690964586E+00, 3.881877876517008E-01, 1.015648880000000E-06),
        Term(2.250768124831000E+00, -4.940429834739583E+00, 5.090989300000000E-07),
        Term(3.422251338868586E+00, -4.977013897776327E+00, 6.537077500000000E-07),
    )

    private val DEIMOS_3 = arrayOf(
        Term(2.981506933511000E+00, -3.154811355556041E-04, 1.562693319959000E-02),
        Term(4.557500894366586E+00, 1.829233626168517E-02, 1.321818631100000E-04),
        Term(3.248124065112586E+00, -9.145934570587952E-03, 3.833652719000000E-05),
        Term(1.701551338710000E+00, 9.145665986601770E-03, 2.660211842000000E-05),
        Term(2.067662003165000E+00, 2.743821959085702E-02, 2.882438535000000E-05),
        Term(4.805327222478586E+00, 3.158564952832469E-04, 2.713213911000000E-05),
        Term(2.318788380092000E+00, 1.860776219134252E-02, 9.296324950000000E-06),
        Term(3.613580709014586E+00, -1.829261290520875E-02, 4.460960290000000E-06),
        Term(5.867810550672586E+00, 3.658405181871115E-02, 4.904156030000000E-06),
        Term(5.496515547817586E+00, -9.461294099629817E-03, 2.366881150000000E-06),
        Term(6.120362957845586E+00, 2.775361064625920E-02, 2.057552850000000E-06),
        Term(3.612389208841586E+00, 8.830178627407989E-03, 2.365750140000000E-06),
        Term(5.554163001934587E+00, -1.860800990265229E-02, 1.228814440000000E-06),
        Term(3.561485983136586E+00, 1.797648948023003E-02, 1.215189460000000E-06),
        Term(1.941975361869000E+00, -6.259843043363501E-04, 9.602856999999999E-07),
        Term(5.845244776759587E+00, -2.743819348074506E-02, 1.174471770000000E-06),
        Term(1.821048365911000E+00, 9.460829229838182E-03, 1.058441050000000E-06),
        Term(7.587135454610000E-01, 1.682177864988152E-04, 2.383147490000000E-06),
        Term(3.292891638604586E+00, 4.573365667404765E-02, 7.656303800000000E-07),
        Term(3.766016108380586E+00, 3.683140215171970E-02, 4.075824300000000E-07),
        Term(5.747244956219586E+00, 9.954342722363187E+00, 4.962340900000000E-07),
        Term(1.724062868741000E+00, -2.774017744689255E-02, 3.003077900000000E-07),
        Term(4.429747729642586E+00, -8.904754331211824E-03, 2.613416400000000E-07),
        Term(8.659161909010000E-01, 2.718340176462802E-02, 2.891945200000000E-07),
        Term(2.259603352363000E+00, -3.660152378331885E-02, 2.213788200000000E-07),
        Term(1.108725025984000E+00, 9.935732440466172E+00, 2.449950300000000E-07),
        Term(1.680391963791000E+00, 9.076040299352415E-03, 1.652416600000000E-07),
    )

    private val SATS = arrayOf(
        // Phobos
        Sat(
            9.549547741038312E-11,
            1.970205562831390E+01,
            1.657852042683113E-10,
            doubleArrayOf(
                0.0000626916188000,
                2.0912973926417302,
                -0.0000005774003141,
                0.0000006185052790,
                -0.0000575018919826,
                -0.0000540676493351,
            ),
            arrayOf(PHOBOS_0, PHOBOS_1, PHOBOS_2, PHOBOS_3),
        ),
        // Deimos
        Sat(
            9.549547622768120E-11,
            4.977013889652300E+00,
            -2.331793571572226E-14,
            doubleArrayOf(
                0.0001568134086700,
                -1.9167537810740201,
                -0.0000239579419518,
                0.0000257893300229,
                -0.0056443721379635,
                -0.0053121806978560,
            ),
            arrayOf(DEIMOS_0, DEIMOS_1, DEIMOS_2, DEIMOS_3),
        ),
    )
}